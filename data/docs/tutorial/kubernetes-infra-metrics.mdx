---
id: kubernetes-infra-metrics
title: Kubernetes Infra Metrics and Logs Collection
description: View Kubernetes infrastructure metrics and logs in SigNoz
hide_table_of_contents: true
---

import K8sMetrics from '@/components/shared/k8s-metrics-list.md'
import HostMetrics from '@/components/shared/hostmetrics-list.md'
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

### Overview
To export Kubernetes metrics, you can enable different receivers in OpenTelemetry
collector which will send metrics about your Kubernetes infrastructure
to SigNoz. These OpenTelemetry collectors will act as agents which send
metrics about Kubernetes to SigNoz.

OtelCollector agent can also be used to tail and parse logs generated by
container using `filelog` receiver and send it to desired receiver.

Based on how you are running SigNoz (e.g. SigNoz Cloud, in an independent VM or Kubernetes cluster),
you have to provide the address to send data from the above receivers.

<Tabs>
  <TabItem value="cloud" label="SigNoz Cloud" default>


## Install otel-collectors in your k8s infra

   ```bash
   helm repo add signoz https://charts.signoz.io
   ```
   If the chart is already present, update the chart to the latest using:
   ```
   helm repo update
   ```

   ```bash
   helm install my-release signoz/k8s-infra  \
  --set otelCollectorEndpoint=ingest.{region}.signoz.cloud:443 \
  --set otelInsecure=false \
  --set signozApiKey=<SIGNOZ_INGESTION_KEY> \
  --set global.clusterName=<CLUSTER_NAME>
  ```

  Depending on the choice of your region for SigNoz cloud, the ingest endpoint will vary according to this table.

  | Region	| Endpoint |
  | --- | --- |
  | US | ingest.us.signoz.cloud:443 |
  | IN | ingest.in.signoz.cloud:443 |
  | EU | ingest.eu.signoz.cloud:443 |
  
### Note
- Replace `SIGNOZ_INGESTION_KEY` with the one provided by SigNoz.
- Replace `<CLUSTER_NAME>` with the name of the Kubernetes cluster or a unique identifier of the
  cluster.


## Send data from applications to OtelCollectors in your infra

<figure data-zoomable align='center'>
    <img src="/img/docs/data-flow-2x.webp" alt="Data flow from your application to SigNoz Cloud"/>
    <figcaption><i>OpenTelemetry instrumented application sends data to OTelAgent Daemon deployed in your k8s infra. The OTelAgent daemon sends the collected data to SigNoz Cloud.</i></figcaption>
</figure>

<br></br>

To send data from your applications, you must first instrument it with OpenTelemetry. You can find instrumentation instructions for your specific language [here](https://signoz.io/docs/instrumentation/). 


Once you're done instrumenting your application, add below to your application manifest files for applications to start sending data to the otel-collectors running as daemonset. Eg. add the below config to the `deployment.yaml` of your application.

```YAML
env:
  - name: HOST_IP
    valueFrom:
      fieldRef:
        fieldPath: status.hostIP
  - name: K8S_POD_IP
    valueFrom:
      fieldRef:
        apiVersion: v1
        fieldPath: status.podIP
  - name: K8S_POD_UID
    valueFrom:
      fieldRef:
        fieldPath: metadata.uid
  - name: OTEL_EXPORTER_OTLP_INSECURE
    value: "true"
  - name: OTEL_EXPORTER_OTLP_ENDPOINT
    value: $(HOST_IP):4317
  - name: OTEL_RESOURCE_ATTRIBUTES
    value: service.name=APPLICATION_NAME,k8s.pod.ip=$(K8S_POD_IP),k8s.pod.uid=$(K8S_POD_UID)
  ```
  
### Note
  - Replace `APPLICATION_NAME` with your application name that you wish to see in SigNoz.
  - In cases of some SDKs, you would have to include `https://` prefix for `OTEL_EXPORTER_OTLP_ENDPOINT`

{/* <!-- ## Plot Metrics in SigNoz UI

To plot metrics generated from `k8s-infra` chart, follow the instructions given in the docs [here][4].

Check out the [List of metrics from Kubernetes receiver][3]. Here are few examples of commonly used metrics dashboard.

1. **Import Dashboard with CPU and Memory Metrics**

You can import dashboard with CPU and Memory metrics of Kubernetes cluster
   containers from [here][5].

2. **Import Dashboard with K8s Metrics**

   You can import dashboard with Kubernetes metrics of K8s cluster from [here][6].

3. **Generate and Import Dashboard with Node Hostmetrics**

   You can import dashboard with Node Hostmetrics of your Kubernetes cluster from
   [here][7].


In the Dashboard page of SigNoz UI, you can create your own widgets as per you
need using metrics from the [list below][3].

---

### List of metrics

<K8sMetrics />

<HostMetrics name="Node Hostmetrics"/> --> */}
{/* 
<!-- ---
[1]: https://github.com/SigNoz/otel-collector-k8s/blob/main/agent/infra-metrics.yaml#L47
[2]: https://github.com/SigNoz/otel-collector-k8s/blob/main/deployment/all-in-one.yaml#L19
[3]: #list-of-metrics
[4]: https://signoz.io/docs/userguide/dashboards/
[5]: https://github.com/SigNoz/dashboards/raw/main/k8s-infra-metrics/cpu-memory-metrics.json
[6]: https://github.com/SigNoz/dashboards/raw/main/k8s-infra-metrics/kubernetes-metrics.json
[7]: https://github.com/SigNoz/dashboards/raw/main/hostmetrics/hostmetrics-k8s.json --> */}

</TabItem>

<TabItem value="self-host" label="Self-Host">

## Steps to export Kubernetes metrics to SigNoz
  
By default, SigNoz Helm chart installs `k8s-infra` dependency chart which handles the task of collecting metrics and logs from the Kubernetes cluster.

`K8s-Infra` helm chart mainly handles the following:
- Tails and parses logs generated by containers in Kubernetes cluster and sends to SigNoz
- Collects kubelet metrics and host metrics from each nodes of the Kubernetes cluster
- Collects cluster-level metrics from the Kubernetes API server
- Acts as a gateway to send any incoming OTLP telemetry data to SigNoz OtelCollector

:::info
Skip **Step 1** if you have single Kubernetes cluster for SigNoz and your applications
as `k8s-infra` chart is included in default SigNoz chart installation.
:::

### Install K8s-Infra chart**

```bash
helm install my-release signoz/k8s-infra  \
--set otelCollectorEndpoint=<IP-or-Endpoint-of-SigNoz-OtelCollector>:4317
```

:::info
If the OtelCollector endpoint is secured, you would have to enable `otelInsecure`
configuration and often make other changes such as including either config
or path to the TLS certificate and private key.
:::


</TabItem>
</Tabs>

## Plot Metrics in SigNoz UI

To plot metrics generated from `k8s-infra` chart, follow the instructions given in the docs [here][4].

Check out the [List of metrics from Kubernetes receiver][3].

Here are some examples of metrics dashboard.

1. **Import Dashboard with PVC Metrics**

   You can import dashboard with PVC metrics of Kubernetes cluster
   from [here][5].

2. **Import Dashboard with Overall Kubernetes pods Metrics**

   You can import dashboard with the general Kubernetes pods metrics of your K8s cluster from [here][6].

3. **Import Dashboard with Detailed Kubernetes pods Metrics**

   You can import dashboard with more detailed granular Kubernetes pods metrics of your K8s cluster from [here][7].

4. **Import Dashboard with Overall Kubernetes Node Metrics**

   You can import dashboard with the general Kubernetes node metrics of your K8s cluster from [here][8].

5. **Import Dashboard with Detailed Kubernetes Node Metrics**

   You can import dashboard with more detailed granular Kubernetes node metrics of your K8s cluster from [here][9].

In the Dashboard page of SigNoz UI, you can create your own widgets as per you
need using metrics from the [list below][3].

---

### List of metrics

<K8sMetrics />

<HostMetrics name="Node Hostmetrics"/>

---

[1]: https://github.com/SigNoz/otel-collector-k8s/blob/main/agent/infra-metrics.yaml#L47
[2]: https://github.com/SigNoz/otel-collector-k8s/blob/main/deployment/all-in-one.yaml#L19
[3]: #list-of-metrics
[4]: https://signoz.io/docs/userguide/dashboards/
[5]: https://github.com/SigNoz/dashboards/blob/main/k8s-infra-metrics/kubernetes-pvc-metrics.json
[6]: https://github.com/SigNoz/dashboards/blob/main/k8s-infra-metrics/kubernetes-pod-metrics-overall.json
[7]: https://github.com/SigNoz/dashboards/blob/main/k8s-infra-metrics/kubernetes-pod-metrics-detailed.json
[8]: https://github.com/SigNoz/dashboards/blob/main/k8s-infra-metrics/kubernetes-node-metrics-overall.json
[9]: https://github.com/SigNoz/dashboards/blob/main/k8s-infra-metrics/kubernetes-node-metrics-detailed.json