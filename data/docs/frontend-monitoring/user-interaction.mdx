---
date: 2024-12-13
title: Frontend Monitoring - User Interactions
id: user-interaction
---

This documentation will provide detailed steps to capture the user interaction of one web application using [OpenTelemetry](https://opentelemetry.io/docs/what-is-opentelemetry/)'s `@opentelemetry/instrumentation-user-interaction` [package](https://github.com/open-telemetry/opentelemetry-js-contrib/tree/main/plugins/web/opentelemetry-instrumentation-user-interaction) and visualize the data in **[Signoz](https://signoz.io/)**.
## Overview
This documentation will walk users through:
* How to instrument web applications with OpenTelemetry to capture user interactions.
* How to send collected telemetry data to **Signoz** for monitoring.
* How to analyze the collected data and set alerts based on it.

By following this guide, users will be able to:
* Automatically capture user interaction such as clicks and more.
* Visualize and query traces in Signoz to monitor the web application performance and user behaviour. 
* Set alerts to get notifications about performance issues. 


## Pre-requisites

1. **SigNoz Setup**:
   - Sign up for [SigNoz Cloud](https://signoz.io/teams/).  
   - Obtain your **SigNoz** access token key in **Settings**.

   ![image](https://hackmd.io/_uploads/HJaOim4x1l.png)  
   *SigNoz Ingestion Settings: View and manage ingestion keys used to send telemetry data to SigNoz (your access token key)*

2. **Basic Requirements**:
   - [Node.js](https://nodejs.org/en/download/package-manager) installed on your local machine.

---

## Step-by-Step Setup (Next.js)

Below is a minimal example using **Next.js**. The instrumentation logic remains identical across frameworks, but we’ll specifically show how to integrate it into Next.js’ structure.

### Step 1: Create a Next.js App

If you don’t already have a Next.js app, create one:

```bash
npx create-next-app my-signoz-nextjs
cd my-signoz-nextjs
```

### Step 2: Add OpenTelemetry Instrumentation

#### 1. Create an `otel-setup.js` File

In your Next.js project, **create** a file named `otel-setup.js`. You can place it in the root of the project or inside a `lib/` or `instrumentation/` folder, for example:

```bash
touch otel-setup.js
```

Add the following code (update `<your-signoz-access-token>` in the `headers` and change the `url` if needed):

```javascript
// otel-setup.js

import { ConsoleSpanExporter, SimpleSpanProcessor } from '@opentelemetry/sdk-trace-base';
import { WebTracerProvider } from '@opentelemetry/sdk-trace-web';
import { UserInteractionInstrumentation } from '@opentelemetry/instrumentation-user-interaction';
import { ZoneContextManager } from '@opentelemetry/context-zone';
import { registerInstrumentations } from '@opentelemetry/instrumentation';
import { OTLPTraceExporter } from '@opentelemetry/exporter-trace-otlp-http';
import { BatchSpanProcessor } from '@opentelemetry/sdk-trace-base';
import { Resource } from '@opentelemetry/resources';
import { SemanticResourceAttributes } from '@opentelemetry/semantic-conventions';

const provider = new WebTracerProvider({
  resource: new Resource({
    [SemanticResourceAttributes.SERVICE_NAME]: 'nextjs-user-interaction',
  }),
});

const exporter = new OTLPTraceExporter({
  // For SigNoz Cloud, set the ingest URL and token:
  url: 'https://ingest.us.signoz.cloud:443/v1/traces',
  headers: {
    'signoz-access-token': '<your-signoz-access-token>',
  },
});

provider.addSpanProcessor(new BatchSpanProcessor(exporter));
provider.addSpanProcessor(new SimpleSpanProcessor(new ConsoleSpanExporter()));

provider.register({
  contextManager: new ZoneContextManager(),
});

// Instrument user interactions
registerInstrumentations({
  instrumentations: [
    new UserInteractionInstrumentation(),
  ],
});

console.log('OpenTelemetry user interaction setup for Next.js initialized');

// EXAMPLE: Simple function to demonstrate user interaction
export function dummyClickHandler() {
  console.log('Click event detected in Next.js app');
}
```

#### 2. Import `otel-setup.js` in `pages/_app.js`

In Next.js, `_app.js` (or `_app.tsx` if using TypeScript) is where you can load global scripts and logic. Import the setup **once** so that it runs automatically when the Next.js application is loaded:

```javascript
// pages/_app.js
import '../otel-setup'; // or wherever you placed otel-setup.js

import React from 'react';

function MyApp({ Component, pageProps }) {
  return <Component {...pageProps} />;
}

export default MyApp;
```

### Step 3: Demonstrate a Simple User Interaction

You can add a button or any interactive element in one of your pages, e.g., in `pages/index.js`:

```javascript
import React from 'react';
import { dummyClickHandler } from '../otel-setup';

export default function HomePage() {
  return (
    <div>
      <h1>OpenTelemetry User Interaction Demo (Next.js)</h1>
      <button onClick={dummyClickHandler}>Click Me!</button>
    </div>
  );
}
```

Now whenever a user clicks **Click Me!**, the user interaction instrumentation will capture relevant span data and send it to SigNoz.

### Step 4: Install Required Packages

Within your Next.js project, install the necessary OpenTelemetry packages:

```bash
npm install @opentelemetry/sdk-trace-web \
            @opentelemetry/instrumentation-user-interaction \
            @opentelemetry/context-zone \
            @opentelemetry/sdk-trace-base \
            @opentelemetry/resources \
            @opentelemetry/semantic-conventions \
            @opentelemetry/exporter-trace-otlp-http \
            @opentelemetry/instrumentation
```

### Step 5: Run the Next.js Dev Server

```bash
npm run dev
```

Open your browser and navigate to the URL shown in the terminal (e.g., `http://localhost:3000/`). Interact with the page (click the button), and your Next.js app will send user interaction events to **SigNoz**.

![image](https://hackmd.io/_uploads/H1kZWN4gke.png)  
*Sample Browser: A simple web page where users interact with*

### Step 6: Verify the Data in SigNoz

1. **Open** your **SigNoz** dashboard.  
2. Navigate to **Traces** and **Services** to verify that user interactions are being captured.

![image](https://hackmd.io/_uploads/Sk45fNExJg.png)  
*SigNoz Trace Explorer view: Monitoring user interactions with detailed telemetry data such as operation name, timestamp, and the duration each operation takes.*

![image](https://hackmd.io/_uploads/HJQCGEVgJe.png)  
*SigNoz Detailed Service Dashboard: Visualize latency, request rates, and Apdex scores over time. p50, p90, and p99 latencies provide insights into how quickly user events (like button clicks) are processed.*

---

## How to Use Collected Data for Monitoring

Once telemetry is captured, you can extend it to track other user interactions such as:
- Form submissions
- Page transitions
- Custom actions

OpenTelemetry sends comprehensive telemetry data, and SigNoz displays these interactions for deeper insight into user behavior and performance bottlenecks.

1. **Real-time Monitoring of User Behavior**  
   The trace data in SigNoz can help identify which features or pages are most used, guiding optimization priorities.

2. **Monitor Performance and Latency**  
   Understand how long each user interaction takes to complete, quickly pinpointing bottlenecks or unresponsive components.

---

## Setting Up [Alerts](https://signoz.io/docs/alerts/) on SigNoz

1. **Create a New Alert Channel**:
   - Go to **Settings** → **Alert Channel**.
   - Choose your preferred alert method (e.g., email, Slack).

![image](https://hackmd.io/_uploads/rJOqsNNgkg.png)  
*Alert Channels Setting: View and manage your alert channels*

![image](https://hackmd.io/_uploads/Ska0s4Ngkl.png)  
*Alert Channels Detailed Setting: Set up your preferred alert method*

2. **Configure the Alert**:
   - Navigate to **+NEW ALERT** to create a new alert rule.

![image](https://hackmd.io/_uploads/rkwECE4eyl.png)  
*Alert Dashboard: View and manage your alerts*

### Sample Trace-Based Alert Setup

![image](https://hackmd.io/_uploads/rJDcA4Nl1g.png)  
*Alert Rules in SigNoz: Tracking button click events with a threshold-based alert. This graph monitors the number of button clicks over time, triggering a warning when clicks exceed a configured threshold (e.g., 10).*

![image](https://hackmd.io/_uploads/S1ssR44eyl.png)  
*Alert Rules in SigNoz: Define which metric to display and monitor.*

![image](https://hackmd.io/_uploads/Sk5pCNExke.png)  
*Alert Rules in SigNoz: Configure the threshold value (e.g., 10) and the information displayed in email alerts.*

When an alert fires, maintainers can respond to critical signals such as surging user interactions, performance slowdowns, or error rates.

Below are **sample alert notifications**:

:::danger
A **FIRING** alert means the monitored metric has exceeded the threshold and needs immediate attention.
:::
![image](https://hackmd.io/_uploads/SJ7_RvExJe.png)  
*Sample Firing Email Alert*

:::success
A **RESOLVED** alert indicates the metric is back within normal limits.
:::
![image](https://hackmd.io/_uploads/HkyA0wEx1x.png)  
*Sample Resolved Email Alert*

---

## Conclusion
By following this guide, you will be able to **automatically capture** user interactions, **send telemetry data to SigNoz** for visualization and monitoring, **analyze user behaviour**, **detect issues** using SigNoz dashboards, and **set alerts** to monitor important events and resolve issues as soon as possible. 

With this setup, you can enhance the observability of your web applications, and improve user traffic and user experience. 

For more information:
- Understand more about OpenTelemetry. Check out this link: https://opentelemetry.io/docs/what-is-opentelemetry/
- Understand more about SigNoz. Check out this link: https://signoz.io/docs/introduction/
