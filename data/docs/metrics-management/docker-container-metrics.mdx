---
date: 2024-12-08
title: Docker container metrics
id: docker-container-metrics
---

This document provides an explains how to monitor Docker container Metrics using OTel Collector and SigNoz.

## Pre-requisites

- [OTel Collector](/docs/tutorial/opentelemetry-binary-usage-in-virtual-machine/).
- Docker API version 1.22+
- Linux (`docker_stats` receiver does not work on Windows or Mac).
- Either a [SigNoz Cloud account](/docs/cloud/) or a [Self-Hosted SigNoz instance](/docs/install/docker/).

## Collecting Docker metrics

You will need to configure [`docker_stats` OpenTelemetry receiver](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/dockerstatsreceiver/README.md) for collecting Docker metrics. The receiver queries the local Docker daemon's container stats API for all desired running containers on a configured interval.

### Configuring the receiver

Edit the OTel Collector config file to configure the `docker_stats` receiver as shown below:

```yaml {2-23}
receivers:
  docker_stats:
    endpoint: unix:///var/run/docker.sock
    metrics:
      container.cpu.utilization:
        enabled: true
      container.memory.percent:
        enabled: true
      container.network.io.usage.rx_bytes:
        enabled: true
      container.network.io.usage.tx_bytes:
        enabled: true
      container.network.io.usage.rx_dropped:
        enabled: true
      container.network.io.usage.tx_dropped:
        enabled: true
      container.memory.usage.limit:
        enabled: true
      container.memory.usage.total:
        enabled: true
      container.blockio.io_service_bytes_recursive:
        enabled: true
```

If you are running OTel Collector on the same machine as Docker daemon, you can remove the `endpoint` line. In case you are running OTel Collector inside a Docker container, make sure you mount the Docker socket from the host machine to the container (`-v /var/run/docker.sock:/var/run/docker.sock`).

The receiver also supports additional parameters like `initial_delay`, `collection_interval`, `timeout` and others. For more details, refer to the [official receiver documentation](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/dockerstatsreceiver/README.md#configuration).

### Configuring the processor

To enrich the collected metrics with additional metadata like hostname and OS, you will need to configure Docker Resource Detection Processor by adding the following configuration to the OTel Collector config file:

```yaml {2-5}
processors:
  resourcedetection/docker:
    detectors: [env, docker]
    timeout: 2s
    override: false
```

### Configuring the pipelines

Once the receiver and processor is configured, make sure to also enable them in the `pipelines` section of the OTel Collector config file:

```yaml {3-4}
service:
  pipelines:
    metrics:
      receivers: [docker_stats]
      processors: [resourcedetection/docker]
```

## Sending Docker metrics to SigNoz

You will also need to configure `exporters` in the OTel Collector config file to send metrics to SigNoz. The configuration will be different based on whether you are using a SigNoz Cloud account or a Self-Hosted SigNoz instance.

### Configuring the exporter

<Tabs>

<TabItem value="cloud" label="SigNoz Cloud" default>

```yaml
exporters:
  otlp:
    endpoint: "ingest.{region}.signoz.cloud:443"
    tls:
      insecure: false
    headers:
      signoz-access-token: "{signoz-token}"
```

You would need to replace `region` and `signoz-token` in the above file with the region of your choice and token obtained from Signoz Cloud → Settings → Ingestion Settings.
</TabItem>

<TabItem value="self-host" label="Self-Host" default>
</TabItem>

</Tabs>

### Updating the pipelines

You will also need to ensure that this exporter is enabled in the `pipelines` section of the OTel Collector config file:

```yaml {5}
service:
  pipelines:
    metrics:
      receivers: [docker_stats]
      exporters: [otlp]
```

## Visualizing Docker Container Metrics

Once you have configured OTel Collector to send Docker metrics to SigNoz, you can start visualizing the metrics in the SigNoz UI.

You can use the pre-configured dashboard for Docker metrics or [create your own custom dashboard](/docs/userguide/manage-dashboards/#steps-to-create-a-custom-dashboard). To use the pre-configured dashboard, download the dashboard JSON from [here](https://github.com/SigNoz/dashboards/blob/main/container-metrics/docker/container-metrics-by-host.json) and import it to SigNoz by clicking Dashboards → New dashboard → Import JSON:

<figure align='center'>
    <img src="/img/docs/metrics/docker/importing_dashboard.webp" width="100%" alt="Importing a pre-configured Dashboard"/>
    <figcaption><i>Importing a pre-configured Dashboard</i></figcaption>
</figure>

The pre-defined `Container Metrics` enables you to select the Docker host from a dropdown list and visualize the following groups of metrics:

- CPU
- Memory
- Network
- Disk

### CPU Metrics

### Memory Metrics

### Network Metrics

### Disk Metrics

## Conclusion

Following this guide, you should have a working setup for collecting Docker container metrics using OTel Collector and visualizing them in SigNoz.

You can find the full list of metrics collected by the `docker_stats` receiver and available for querying in dashboards [in the official receiver documentation](https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/dockerstatsreceiver/documentation.md).
